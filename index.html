<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pendaftaran Anggota HDS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{background:#e8efe9;}
.card{border-radius:18px;}
input,textarea,select{border-radius:10px;}
</style>
</head>

<body class="container py-4">

<h3 class="text-center mb-3">FORM PENDAFTARAN ANGGOTA HDS</h3>

<div class="card p-3 shadow-sm">
<form id="form">

<input type="file" id="foto" class="form-control mb-2" accept="image/*" required>

<input class="form-control mb-2" placeholder="Nama Lengkap" id="nama" required>
<input class="form-control mb-2" placeholder="No Telepon" id="telp" required>
<input class="form-control mb-2" placeholder="Email" id="email" type="email" required>

<!-- ASAL KAMPUNG -->
<select class="form-control mb-2" id="asal" required>
  <option value="">-- Pilih Asal Kampung --</option>
</select>

<textarea class="form-control mb-2" placeholder="Tanggal Bergabung" id="tanggal" required></textarea>
<textarea class="form-control mb-2" placeholder="Alasan Bergabung" id="alasan" required></textarea>
<textarea class="form-control mb-2" placeholder="Minat & Bakat" id="minat" required></textarea>
<textarea class="form-control mb-2" placeholder="Motivasi" id="motivasi" required></textarea>
<textarea class="form-control mb-2" placeholder="Harapan" id="harapan" required></textarea>

<select class="form-control mb-2" id="bagian" required>
  <option value="">-- Pilih Bagian --</option>
  <option>Ketua</option>
  <option>Sekretaris</option>
  <option>Bendahara</option>
  <option>Rohani</option>
  <option>Kebudayaan</option>
  <option>Sosial</option>
  <option>Pendidikan</option>
  <option>Kewirausahaan</option>
  <option>Koordinator Kampung</option>
  <option>Lainnya</option>
</select>

<input class="form-control mb-2" placeholder="User ID" id="userid" required>
<input class="form-control mb-2" placeholder="Password" type="password" id="password" required>

<button class="btn btn-success w-100 mt-2">DAFTAR</button>
</form>
</div>

<div class="text-center mt-3">
<a href="https://formportal-lab.github.io/data-peserta/" class="btn btn-outline-dark btn-sm">üîç Lihat Data Peserta</a>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// ================= FIREBASE =================
firebase.initializeApp({
 apiKey: "AIzaSyBO1aP-TRHwbM1fDj-rvalwZBcjBDG1UEU",
 authDomain: "formdatahds.firebaseapp.com",
 projectId: "formdatahds",
 storageBucket: "formdatahds.firebasestorage.app",
 messagingSenderId: "932072482968",
 appId: "1:932072482968:web:04627434d42966d6ec88ed"
});
const db = firebase.database();

// ================= DAFTAR KAMPUNG =================
const DAFTAR_KAMPUNG = [
 "SEKONAU","CUKA HILIR","SEGIAM HULU","KAKI RIAM","MORAN","ODONG",
 "KUNSIT","NANGA BIABAN","BANDAN","GEDET","KIATAK","BAU","LANDAS"
];

// isi dropdown kampung
const asalSelect = document.getElementById("asal");
DAFTAR_KAMPUNG.forEach(k => {
  const opt = document.createElement("option");
  opt.value = k;
  opt.textContent = k;
  asalSelect.appendChild(opt);
});

// ================= SUBMIT FORM =================
form.onsubmit = e => {
  e.preventDefault();

  // validasi kampung
  if (!DAFTAR_KAMPUNG.includes(asal.value)) {
    alert("Asal kampung tidak valid!");
    return;
  }

  // validasi userid (tanpa spasi)
  if (userid.value.includes(" ")) {
    alert("User ID tidak boleh mengandung spasi");
    return;
  }

  const reader = new FileReader();
  reader.onload = () => {

    db.ref("anggota/" + userid.value).set({
      nama: nama.value,
      telp: telp.value,
      email: email.value,
      asal: asal.value, 
      tanggal: tanggal.value,
      alasan: alasan.value,
      motivasi: motivasi.value,
      minat: minat.value,
      harapan: harapan.value,
      bagian: bagian.value,
      foto: reader.result
    });

    db.ref("credential/" + userid.value).set({
      password: password.value
    });

    alert("‚úÖ Pendaftaran berhasil!");
    form.reset();
  };

  reader.readAsDataURL(foto.files[0]);
};
</script>

</body>
</html>
